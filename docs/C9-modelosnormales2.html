<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>PUCTallerdeR</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./C10-modelosnonparametricos.html" rel="next">
<link href="./C8-modelosnormales1.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./clases.html">Clases</a></li><li class="breadcrumb-item"><a href="./C9-modelosnormales2.html">Modelos lineales</a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">PUCTallerdeR</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bienvenidos</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Horario.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Horario</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./clases.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Clases</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C1-Intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">C1-Intro</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C2-RMarkdown.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">C2-RMarkdown</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C3-Tidyverse.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">C3-Tidyverse</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C4-GGplot1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">C4-GGPlot1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C5-GGplot2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">C5-GGplot2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C6-normalizacion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">C6-normalizacion</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C7-correlacion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">C7-correlacion</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C8-modelosnormales1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Anova &amp; Kruskal-Wallis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C9-modelosnormales2.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Modelos lineales</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C10-modelosnonparametricos.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Variables con GLM/GAM</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C11-Graficos.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">C11-Gráficos del communicación</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./proyectos.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Proyectos</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Proyecto1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Proyecto1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Proyecto2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Proyecto2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Proyecto3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Proyecto3</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#modelos-lineales" id="toc-modelos-lineales" class="nav-link active" data-scroll-target="#modelos-lineales">Modelos lineales</a></li>
  <li><a href="#como-funciona-los-modelos-lineales" id="toc-como-funciona-los-modelos-lineales" class="nav-link" data-scroll-target="#como-funciona-los-modelos-lineales">¿Como funciona los modelos lineales?</a></li>
  <li><a href="#empezando-con-glm" id="toc-empezando-con-glm" class="nav-link" data-scroll-target="#empezando-con-glm">Empezando con GLM</a></li>
  <li><a href="#opciones-para-evaluar" id="toc-opciones-para-evaluar" class="nav-link" data-scroll-target="#opciones-para-evaluar">Opciones para evaluar</a></li>
  <li><a href="#familia-y-supuestos" id="toc-familia-y-supuestos" class="nav-link" data-scroll-target="#familia-y-supuestos">familia y supuestos</a>
  <ul class="collapse">
  <li><a href="#sintaxis-completo-para-un-glm" id="toc-sintaxis-completo-para-un-glm" class="nav-link" data-scroll-target="#sintaxis-completo-para-un-glm">Sintaxis completo para un glm</a></li>
  <li><a href="#emepzar-con-una-familia-si-no-elije-una-es-gaussian" id="toc-emepzar-con-una-familia-si-no-elije-una-es-gaussian" class="nav-link" data-scroll-target="#emepzar-con-una-familia-si-no-elije-una-es-gaussian">1. Emepzar con una familia (si no elije una, es Gaussian)</a></li>
  </ul></li>
  <li><a href="#elegiendo-modelo-mejor" id="toc-elegiendo-modelo-mejor" class="nav-link" data-scroll-target="#elegiendo-modelo-mejor">Elegiendo modelo mejor</a>
  <ul class="collapse">
  <li><a href="#eliminación-hacia-atrás-con-drop1aic" id="toc-eliminación-hacia-atrás-con-drop1aic" class="nav-link" data-scroll-target="#eliminación-hacia-atrás-con-drop1aic">1. Eliminación hacia atrás con Drop1/AIC</a></li>
  <li><a href="#regresión-forward" id="toc-regresión-forward" class="nav-link" data-scroll-target="#regresión-forward">2. regresión ‘forward’</a></li>
  <li><a href="#regresión-backward" id="toc-regresión-backward" class="nav-link" data-scroll-target="#regresión-backward">3. regresión ‘backward’</a></li>
  </ul></li>
  <li><a href="#recursos-adicionales" id="toc-recursos-adicionales" class="nav-link" data-scroll-target="#recursos-adicionales">recursos adicionales</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">




<section id="modelos-lineales" class="level1">
<h1>Modelos lineales</h1>
<p>Había un montón de tipos de modelos que puede ocupar para analizar sus datos, desde lo más básico hasta ellos que pueden tomar combinaciones complicadas para representar sus datos. El prepósito de un modelo, generalmente, es crear una combinación de variables que puede representar una relación entre variables en una manera correcta y que crear valores predictivos.</p>
<p>Con sistemas naturales, la idea puede ser tener predicciones para el futuro, pero frecuentemente se interesa mas la pregunta si haya relaciones entre variables o no.</p>
<p>Es super importante tener y saber una hipótesis acá, y anota que nunca puede probar que tu hipótesis es verdad, sino que significancia decía que no hay evidencia que tu hipótesis es incorrecto. Tampoco, puede decir que una variable explicativa causa su variable de respuesta.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Correlation_Vs_Causation_-_2019-es.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="600"></p>
</figure>
</div>
<p>¡Por esta razón, su interpretación de sus propios resultados con conocimiento profundo de su proyecto es super importante!</p>
<p>Casi nunca puede decir que algo causa otra, pero si conozca bien su proyecto y sistema, podría elucidar conclusiones e ideas desde sus correlaciones.</p>
</section>
<section id="como-funciona-los-modelos-lineales" class="level1">
<h1>¿Como funciona los modelos lineales?</h1>
<p>De nivel más básico, un modelo lineal toma dos variables y te cuenta la relación entre los dos, incluyendo si suben/bajan juntos y con qué incremento. &nbsp;</p>
<p>La fórmula super básico es así:</p>
<p><strong>Y = mX + b</strong></p>
<p>X e Y son tus variables explicativas (X) y respuesta (Y)</p>
<p>M es la inclinación, o sea, el rato de cambio por Y con cada unidad de X</p>
<p>B es la intersección (o sea, cuando no hay ninguna del Y: ¿cuántas unidades del X hay?)</p>
<p>Entonces, desde un modelo lineal básico, puede aprender mucho. Este tipo de modelo mas básico, con una variable de respuesta y una variable explicativa es un modelo lineal, y se usa el función ‘lm()’</p>
<p>Por ejemplo:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>ac <span class="sc">%&gt;%</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>AcaroBrachy, <span class="at">y=</span>CuentaAgua))<span class="sc">+</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">"lm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="C9-modelosnormales2_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>lmej <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>ac, AcaroBrachy <span class="sc">~</span> CuentaAgua)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lmej)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = AcaroBrachy ~ CuentaAgua, data = ac)

Residuals:
    Min      1Q  Median      3Q     Max 
-11.540  -6.439  -2.891   3.974  31.352 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 17.736018   3.545694   5.002 4.24e-06 ***
CuentaAgua  -0.021935   0.008165  -2.687  0.00906 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 9.655 on 68 degrees of freedom
Multiple R-squared:  0.09596,   Adjusted R-squared:  0.08267 
F-statistic: 7.218 on 1 and 68 DF,  p-value: 0.009063</code></pre>
</div>
</div>
<p>Eso es un ejemplo básico, pero normalmente en ecología/agronomía, los datos y relaciones son complicados. Si haya algo en el campo, tendría mas que una variable explicativa, porque hay otras cosas que se afectan su variable respuesta. Además, hay mas etapas que hacer su gráfico y después el modelo. Los supuestos son super importantes y sus tipos de datos también. Así que, empezamos con GLM.</p>
</section>
<section id="empezando-con-glm" class="level1">
<h1>Empezando con GLM</h1>
<p>GLMs son similares a modelos lineales, pero son mas flexible, y tienen poquito más tolerancia a residuos non-normales. Entonces, puede hacer un análisis/modelo más complicado con GLM.</p>
<p>Para hacer un modelo, necesita una pregunta y/o una hipótesis.</p>
<p>Por ejemplo: acá tenemos la abundancia de Acaro Brachy, densidad del sustrato, cantidad del agua en el sustrato, sustrato, nivel de cobertura de arbustos y topografia. Supongo que la pregunta central es cuales factores se impactan lo distribución de Acaro Brachy.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(ac)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  AcaroBrachy DensSustrato CuentaAgua  Sustrato Arbusto    Topo
1          17        39.18     350.15   Sphagn1     Few Hummock
2           2        54.99     434.81    Litter     Few Hummock
3           4        46.07     371.72 Interface     Few Hummock
4          23        48.19     360.50   Sphagn1     Few Hummock
5           5        23.55     204.13   Sphagn1     Few Hummock
6          19        57.32     311.55   Sphagn1     Few Hummock</code></pre>
</div>
</div>
<p>La hipótesis puede incluir algunas de las variables o todos.</p>
<p>Una hipótesis puede ser así: Habría una abundancia más alta de Acaro Brachy con sustratos mas densos y un nivel de cobertura de arbustos menos denso.. Entonces, probamos los variables ‘DensSustrato’ y ‘Arbusto’. Podemos incluir también el resto, pero no son lo prioridad.</p>
<p>Una pregunta puede ser: ¿Cuáles factores medio ambientales impacta la abundancia del Acaro Brachy?</p>
<p>Así podemos usar todos los variables para ver cual tiene impacto.</p>
<ul>
<li>No olvide a cambiar los tipos de datos ANTES de hacer modelos (y si quiere, transformar)</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>ac<span class="sc">$</span>DensSustrato <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(ac<span class="sc">$</span>DensSustrato)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>ac<span class="sc">$</span>CuentaAgua <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(ac<span class="sc">$</span>CuentaAgua)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>ac<span class="sc">$</span>Sustrato <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(ac<span class="sc">$</span>Sustrato)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>ac<span class="sc">$</span>Arbusto <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(ac<span class="sc">$</span>Arbusto)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>ac<span class="sc">$</span>Topo <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(ac<span class="sc">$</span>Topo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Y sacar sus outliers</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>ac <span class="sc">%&gt;%</span> </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">identify_outliers</span>(AcaroBrachy)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   AcaroBrachy DensSustrato CuentaAgua  Sustrato Arbusto    Topo is.outlier
11          36        35.59     134.13   Sphagn3    Many Blanket       TRUE
12          28        46.80     405.91   Sphagn1     Few Hummock       TRUE
14          41        37.25     239.51 Interface    Many Blanket       TRUE
29          42        32.86     323.12 Interface    Many Hummock       TRUE
33          38        36.44     387.30   Sphagn2     Few Blanket       TRUE
   is.extreme
11      FALSE
12      FALSE
14       TRUE
29       TRUE
33      FALSE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>quartiles <span class="ot">&lt;-</span> <span class="fu">quantile</span>(ac<span class="sc">$</span>AcaroBrachy, <span class="at">probs=</span><span class="fu">c</span>(.<span class="dv">25</span>, .<span class="dv">75</span>), <span class="at">na.rm =</span> <span class="cn">FALSE</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>IQR <span class="ot">&lt;-</span> <span class="fu">IQR</span>(ac<span class="sc">$</span>AcaroBrachy)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"># -3 deviaciónes estander </span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>Lower <span class="ot">&lt;-</span> quartiles[<span class="dv">1</span>] <span class="sc">-</span> <span class="fl">1.5</span><span class="sc">*</span>IQR</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="co"># +3 deviaciónes estander</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>Upper <span class="ot">&lt;-</span> quartiles[<span class="dv">2</span>] <span class="sc">+</span> <span class="fl">1.5</span><span class="sc">*</span>IQR </span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>acso <span class="ot">&lt;-</span> <span class="fu">subset</span>(ac, ac<span class="sc">$</span>AcaroBrachy <span class="sc">&gt;</span> Lower <span class="sc">&amp;</span> ac<span class="sc">$</span>AcaroBrachy <span class="sc">&lt;</span> Upper)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Además debería probar por correlaciónes antes</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrgram)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'corrgram'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:lattice':

    panel.fill</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>acc <span class="ot">&lt;-</span> ac[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">corrgram</span>(acc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="C9-modelosnormales2_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="opciones-para-evaluar" class="level1">
<h1>Opciones para evaluar</h1>
<p>Lo mejor modelo es lo mas simple, o sea, con la cantidad menor de variables explicativas. Pero, es importante considerar todos los variables que quizás afectan su variable respuesta. Y por eso, el numero de observaciones es importante: no puede usar mas variables explicativas que observaciones, y de hecho si tiene menos de diez observaciones debería usar menos variables explicativas que la mitad de sus observaciones.</p>
</section>
<section id="familia-y-supuestos" class="level1">
<h1>familia y supuestos</h1>
<p>Es super importante usar una familia que tiene sentido por sus datos. Además, algunas familias son poquito mas tolerante a datos con mas varianza o nonnormalidad (pero todavía necesita probar estas supuestos)</p>
<p>Puede elegir su familia antes de hacer algo (de hecho, debe saber cual piensa que te sirve antes), pero igual puede probarlas con los supuestos.</p>
<section id="sintaxis-completo-para-un-glm" class="level3">
<h3 class="anchored" data-anchor-id="sintaxis-completo-para-un-glm">Sintaxis completo para un glm</h3>
<p>glm(data=data, var_res ~ var_exp1 + var_exp2 + var_exp3 * var_exp4, family=“poisson”)</p>
</section>
<section id="emepzar-con-una-familia-si-no-elije-una-es-gaussian" class="level3">
<h3 class="anchored" data-anchor-id="emepzar-con-una-familia-si-no-elije-una-es-gaussian">1. Emepzar con una familia (si no elije una, es Gaussian)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># acá es gaussian</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>ABBase <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="at">data=</span>ac, AcaroBrachy <span class="sc">~</span> DensSustrato <span class="sc">+</span> CuentaAgua <span class="sc">+</span> Sustrato <span class="sc">+</span> Topo)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>simResABBase <span class="ot">&lt;-</span><span class="fu">simulateResiduals</span>(ABBase) <span class="co">#DHARMa: hace resiudos y graficos para evaluar normalidad y homogeneidad de varianza</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="co"># si hay líneas super curvados, rojo o valor P&lt;0.05) en el QQ plot (izquierda) no vale</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(simResABBase)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="C9-modelosnormales2_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># entonces acá es malo</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># intenta de nuevo con distinta familia (binomio negativo)</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>ABBaseBN <span class="ot">&lt;-</span> <span class="fu">glm.nb</span>(<span class="at">data=</span>ac, AcaroBrachy <span class="sc">~</span> DensSustrato <span class="sc">+</span> CuentaAgua <span class="sc">+</span> Sustrato <span class="sc">+</span> Topo)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>simResABBaseBN <span class="ot">&lt;-</span><span class="fu">simulateResiduals</span>(ABBaseBN) <span class="co">#DHARMa: hace resiudos y graficos para evaluar normalidad y homogeneidad de varianza</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="co"># si hay líneas super curvados, rojo o valor P&lt;0.05) en el QQ plot (izquierda) no vale</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(simResABBaseBN)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="C9-modelosnormales2_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># mejor, pero todavia con problemas</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># intenta de nuevo con distinta familia (binomio negativo)</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>ABBasep <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="at">data=</span>ac, AcaroBrachy <span class="sc">~</span> DensSustrato <span class="sc">+</span> CuentaAgua <span class="sc">+</span> Sustrato <span class="sc">+</span> Topo, <span class="at">family=</span><span class="st">"poisson"</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>simResABBasep <span class="ot">&lt;-</span><span class="fu">simulateResiduals</span>(ABBasep) <span class="co">#DHARMa: hace resiudos y graficos para evaluar normalidad y homogeneidad de varianza</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="co"># si hay líneas super curvados, rojo o valor P&lt;0.05) en el QQ plot (izquierda) no vale</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(simResABBasep)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="C9-modelosnormales2_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># superrr mal</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Ninguno de estos tres modelos se cumple con los supuestos. Pero, puede elegir lo que es mejor ahora, porque a veces cuando eliminar variables, resultara que uno u otro fue el problema. Hice esto con los valores del criterio de información de Akaike (CIA o AIC).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MuMIn)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>lr_output.AIC <span class="ot">&lt;-</span> <span class="fu">model.sel</span>(ABBase, ABBaseBN, ABBasep) <span class="co"># incluir los modelos de interés</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>lr_AIC.table<span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(lr_output.AIC)[<span class="dv">7</span><span class="sc">:</span><span class="dv">12</span>] <span class="co"># estas columnas pueden cambiar, entonces puede ver en el tab 'environment' también</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>lr_AIC.table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          class init.theta link df    logLik     AICc
ABBaseBN negbin       1.39  log 11 -211.5763 449.7044
ABBase      glm                 11 -250.1195 526.7907
ABBasep     glm                 10 -352.4087 728.5461</code></pre>
</div>
</div>
<p>Acá la mejor familia es el binomio negativo, que también fue lo mas cerca a normal según los gráficos. Entonces parte allá. Antes que sigue, tenemos que probar el intercorrelación también con ‘VIF’ del paquete ‘car’.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(ABBaseBN) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 GVIF Df GVIF^(1/(2*Df))
DensSustrato 1.278126  1        1.130542
CuentaAgua   1.537536  1        1.239974
Sustrato     1.650343  6        1.042632
Topo         1.529773  1        1.236840</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># todos los valores deben ser &lt;2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>No hay intercorrelación problemática, entonces siga.</p>
</section>
</section>
<section id="elegiendo-modelo-mejor" class="level1">
<h1>Elegiendo modelo mejor</h1>
<p>Había ambas opciones para elegir un modelo, y eliminar variables que son menos importante. Acá muestra tres básicos:</p>
<section id="eliminación-hacia-atrás-con-drop1aic" class="level3">
<h3 class="anchored" data-anchor-id="eliminación-hacia-atrás-con-drop1aic">1. Eliminación hacia atrás con Drop1/AIC</h3>
<p>Con regresión eliminación hacia atrás, empezamos con todas las variables y eliminarlas uno a uno hasta que queda uno y después elige lo mejor modelo con AIC. Esto es bueno porque puede elegir una a una las variables que son más o menos efectivo. Es malo si tiene algunas variables si son obligatorias dejar.</p>
<ol type="1">
<li>Empieza con un modelo con todas sus variables explicativas. Elegir una familia adecuada y probar por correlación/normalidad/homogeneidad de varianza.</li>
<li>Usar ‘drop1’ con prueba preferida (‘chisq’ es mi favorito) para identificar la variable con lo menor impacto</li>
<li>Hacer un nuevo modelo con este variable eliminado</li>
<li>Rehacerlo hasta que queda uno o que todos son significantes</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># parte con 'ABBaseBN' del los modelos que ya he hecho</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">drop1</span>(ABBaseBN, <span class="at">test=</span><span class="st">"Chisq"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Single term deletions

Model:
AcaroBrachy ~ DensSustrato + CuentaAgua + Sustrato + Topo
             Df Deviance    AIC     LRT Pr(&gt;Chi)  
&lt;none&gt;            75.355 443.15                   
DensSustrato  1   76.135 441.93  0.7795  0.37729  
CuentaAgua    1   78.456 444.25  3.1005  0.07827 .
Sustrato      6   91.139 446.94 15.7843  0.01496 *
Topo          1   81.171 446.97  5.8160  0.01588 *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># lo menos fuerte es DensSustrato (número más grande)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>ABBaseBN2 <span class="ot">&lt;-</span> <span class="fu">glm.nb</span>(<span class="at">data=</span>ac, AcaroBrachy <span class="sc">~</span> CuentaAgua <span class="sc">+</span> Sustrato <span class="sc">+</span> Topo)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>simResABBaseBN2 <span class="ot">&lt;-</span><span class="fu">simulateResiduals</span>(ABBaseBN2) <span class="co">#DHARMa: hace resiudos y graficos para evaluar normalidad y homogeneidad de varianza</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="co"># si hay líneas super curvados, rojo o valor P&lt;0.05) en el QQ plot (izquierda) no vale</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(simResABBaseBN2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="C9-modelosnormales2_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># todavia no cumple con los supuestos</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>De nuevo</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">drop1</span>(ABBaseBN2, <span class="at">test=</span><span class="st">"Chisq"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Single term deletions

Model:
AcaroBrachy ~ CuentaAgua + Sustrato + Topo
           Df Deviance    AIC     LRT Pr(&gt;Chi)  
&lt;none&gt;          75.357 441.93                   
CuentaAgua  1   77.882 442.45  2.5244  0.11209  
Sustrato    6   90.229 444.80 14.8716  0.02128 *
Topo        1   80.967 445.54  5.6095  0.01786 *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># cuenta agua</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>ABBaseBN3 <span class="ot">&lt;-</span> <span class="fu">glm.nb</span>(<span class="at">data=</span>ac, AcaroBrachy <span class="sc">~</span> Sustrato <span class="sc">+</span> Topo)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>simResABBaseBN3 <span class="ot">&lt;-</span><span class="fu">simulateResiduals</span>(ABBaseBN3) </span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(simResABBaseBN3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="C9-modelosnormales2_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># excelente! Ahora se cumple con los supuestos</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>De nuevo</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">drop1</span>(ABBaseBN3, <span class="at">test=</span><span class="st">"Chisq"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Single term deletions

Model:
AcaroBrachy ~ Sustrato + Topo
         Df Deviance    AIC    LRT Pr(&gt;Chi)   
&lt;none&gt;        75.588 442.41                   
Sustrato  6   97.390 452.21 21.803 0.001315 **
Topo      1   85.592 450.42 10.004 0.001562 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># todo tiene significancia, entonces podemos parar</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Así que ahora todo es significante, es la hora de probar todos los modelos con AIC.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MuMIn)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>lr_output.AIC <span class="ot">&lt;-</span> <span class="fu">model.sel</span>(ABBase, ABBaseBN, ABBasep, ABBaseBN2, ABBaseBN3) <span class="co"># incluir los modelos de interés</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>lr_AIC.table<span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(lr_output.AIC)[<span class="dv">7</span><span class="sc">:</span><span class="dv">12</span>] <span class="co"># estas columnas pueden cambiar, entonces puede ver en el tab 'environment' también</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>lr_AIC.table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           class init.theta link df    logLik     AICc
ABBaseBN3 negbin       1.31  log  9 -213.2054 447.4108
ABBaseBN2 negbin       1.37  log 10 -211.9637 447.6561
ABBaseBN  negbin       1.39  log 11 -211.5763 449.7044
ABBase       glm                 11 -250.1195 526.7907
ABBasep      glm                 10 -352.4087 728.5461</code></pre>
</div>
</div>
<p>ABBaseBN3, o sea el último, es lo mejor modelo.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># probar supuestos </span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>simResABBaseBN3 <span class="ot">&lt;-</span><span class="fu">simulateResiduals</span>(ABBaseBN3) </span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(simResABBaseBN3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="C9-modelosnormales2_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(ABBaseBN3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            GVIF Df GVIF^(1/(2*Df))
Sustrato 1.19508  6        1.014962
Topo     1.19508  1        1.093197</code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ABBaseBN3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: not plotting observations with leverage one:
  11</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="C9-modelosnormales2_files/figure-html/unnamed-chunk-19-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="C9-modelosnormales2_files/figure-html/unnamed-chunk-19-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="C9-modelosnormales2_files/figure-html/unnamed-chunk-19-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="C9-modelosnormales2_files/figure-html/unnamed-chunk-19-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Así que el modelo se cumple con todos los supuestos, ve los resultados.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># resultados</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ABBaseBN3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm.nb(formula = AcaroBrachy ~ Sustrato + Topo, data = ac, init.theta = 1.314842229, 
    link = log)

Coefficients:
                    Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)        1.546e+00  2.430e-01   6.361    2e-10 ***
SustratoSphagn2    5.695e-01  3.469e-01   1.642 0.100644    
SustratoSphagn3    2.038e+00  9.205e-01   2.214 0.026833 *  
SustratoSphagn4   -7.038e-01  7.198e-01  -0.978 0.328182    
SustratoLitter    -9.743e-01  7.782e-01  -1.252 0.210588    
SustratoBarepeat  -2.985e+01  6.000e+05   0.000 0.999960    
SustratoInterface  3.404e-01  2.778e-01   1.225 0.220453    
TopoHummock        8.630e-01  2.558e-01   3.374 0.000741 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for Negative Binomial(1.3148) family taken to be 1)

    Null deviance: 103.660  on 69  degrees of freedom
Residual deviance:  75.588  on 62  degrees of freedom
AIC: 444.41

Number of Fisher Scoring iterations: 1

              Theta:  1.315 
          Std. Err.:  0.261 

 2 x log-likelihood:  -426.411 </code></pre>
</div>
</div>
<p>Así que los dos variables que quedan son factores, en los resultados, se muestra todos los niveles y su significancia. Que puede decir desde los resultados?</p>
<p>La primera colúmna (Estimate) es la inclinación del modelo. O sea que comparado al intercept, el sustrato Sphagn2 tiene 0.5x la abundancia del intercept. Es imporante ver y tener en cuenta la inclinación porque puede tener un modelo que tiene muchísimas variables significantes, pero la diferencia es super poco (por ejemplo solo gana un más abeja). En el ‘estimate’ un valor positivo es más grande, y negativo es más chico.</p>
<p>‘Std. error’ o sea, error estander, es el error. Siempre hay duda en modelos, pero un modelo super bien tiene un nivel bajo de duda, o sea, un error estander más chico.</p>
<p>El Z-value (o t-value) es importante porque puede evaluar la fuerza del estimación por variable. O sea, su Z/T es su estimate dividio por el error. Entonces, un valor más chico tiene un error más grande, y tiene más duda.</p>
<p>El Pr es su valor p.&nbsp;Usa eso para evaluar significancia. Había un superenfoque en significancia en ecologia, pero debería leer bien todo, porque es super posible que tiene un modelo significante pero debíl. Las estrellas significa cuales variables son significadamente distinto al resto (o sea, que tiene una abundancia significiativamente alto o bajo comparado al resto).</p>
<p>Vamos a hablar de más indicaciones del fuerza de su modelo más adelante.</p>
</section>
<section id="regresión-forward" class="level3">
<h3 class="anchored" data-anchor-id="regresión-forward">2. regresión ‘forward’</h3>
<p>Usa regresión forward para añadir de forma rapido las variables más impactantes.</p>
<p>Empece con un modelo vacio (o sea var.res ~ 1), sin variables explicativas y un modelo con todas las variables de interés.</p>
<p>Usa el función ‘step’ para elegir la proxima variable que debería añadir hasta que nada son significados en step.</p>
<p>Puede probar/elegir su modelo mejor con AIC y no olvide a probar los supuestos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>ModVac <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="at">data=</span>ac, AcaroBrachy <span class="sc">~</span> <span class="dv">1</span>) <span class="co"># modelo con ninguna variable explicativa</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>ModTodo <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="at">data=</span>ac, AcaroBrachy <span class="sc">~</span> DensSustrato <span class="sc">+</span> CuentaAgua <span class="sc">+</span> Sustrato <span class="sc">+</span> Topo ) <span class="co"># modelo con todas las variables explicativas</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="co"># nombre       step(partida, scope=list(lower=vacio, upper=todo))</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>Mod_forward <span class="ot">&lt;-</span> <span class="fu">step</span>(ModVac, <span class="at">scope=</span><span class="fu">list</span>(<span class="at">lower=</span>ModVac, <span class="at">upper=</span>ModTodo))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=525.13
AcaroBrachy ~ 1

               Df Deviance    AIC
+ CuentaAgua    1   6339.0 520.07
+ Topo          1   6569.2 522.57
&lt;none&gt;              7011.8 525.13
+ Sustrato      6   5972.4 525.90
+ DensSustrato  1   6956.2 526.57

Step:  AIC=520.07
AcaroBrachy ~ CuentaAgua

               Df Deviance    AIC
&lt;none&gt;              6339.0 520.07
+ Topo          1   6214.4 520.68
+ DensSustrato  1   6335.6 522.03
+ Sustrato      6   5595.7 523.34
- CuentaAgua    1   7011.8 525.13</code></pre>
</div>
</div>
<p>Acá tiene dos respuestas a la pregunta, cuales variables son mejores por el modelo. Usa AIC para decidir, y puede ver que el modelo mejor con un variable es Cuenta Agua y no se da un modelo con 2 variables porque no sea mejor.</p>
<p>Pero, si ya no he probado sus supuestos, esto puede ser equivocado. Por ejemplo, los modelos acá están hechos con la familia gaussian, que es malo. Si hace de nuevo con binomio negativo, cambiaría los datos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>ModVac <span class="ot">&lt;-</span> <span class="fu">glm.nb</span>(<span class="at">data=</span>ac, AcaroBrachy <span class="sc">~</span> <span class="dv">1</span>)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>ModTodo <span class="ot">&lt;-</span> <span class="fu">glm.nb</span>(<span class="at">data=</span>ac, AcaroBrachy <span class="sc">~</span> DensSustrato <span class="sc">+</span> CuentaAgua <span class="sc">+</span> Sustrato <span class="sc">+</span> Topo )</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>Mod_forward <span class="ot">&lt;-</span> <span class="fu">step</span>(ModVac, <span class="at">scope=</span><span class="fu">list</span>(<span class="at">lower=</span>ModVac, <span class="at">upper=</span>ModTodo))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=452.91
AcaroBrachy ~ 1

               Df Deviance    AIC
+ CuentaAgua    1   70.120 445.31
+ Topo          1   75.104 450.29
+ Sustrato      6   65.567 450.75
&lt;none&gt;              79.723 452.91
+ DensSustrato  1   78.808 453.99

Step:  AIC=444.64
AcaroBrachy ~ CuentaAgua

               Df Deviance    AIC
+ Topo          1   76.299 443.93
&lt;none&gt;              79.011 444.64
+ Sustrato      6   68.180 445.81
+ DensSustrato  1   78.955 446.59
- CuentaAgua    1   90.013 453.64

Step:  AIC=443.88
AcaroBrachy ~ CuentaAgua + Topo

               Df Deviance    AIC
+ Sustrato      6   65.652 442.76
&lt;none&gt;              78.772 443.88
- Topo          1   81.581 444.69
+ DensSustrato  1   78.763 445.87
- CuentaAgua    1   87.467 450.58

Step:  AIC=441.93
AcaroBrachy ~ CuentaAgua + Topo + Sustrato

               Df Deviance    AIC
&lt;none&gt;              75.357 441.93
- CuentaAgua    1   77.882 442.45
+ DensSustrato  1   74.587 443.16
- Sustrato      6   90.229 444.80
- Topo          1   80.967 445.54</code></pre>
</div>
</div>
<p>Así que ahora ocupa la familia adecuada, había más opciones. Había modelos hasta tres variables explicativas y lo mejor AIC es lo con tres.</p>
<p>Probamos esta variable:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>RF3 <span class="ot">&lt;-</span> <span class="fu">glm.nb</span>(<span class="at">data=</span>ac, AcaroBrachy <span class="sc">~</span> CuentaAgua <span class="sc">+</span> Topo <span class="sc">+</span> Sustrato)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>simResRF3 <span class="ot">&lt;-</span><span class="fu">simulateResiduals</span>(RF3) </span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(simResRF3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="C9-modelosnormales2_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(RF3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               GVIF Df GVIF^(1/(2*Df))
CuentaAgua 1.420439  1        1.191822
Topo       1.524958  1        1.234892
Sustrato   1.425558  6        1.029988</code></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># podemos ver que no es exactamente bien</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(RF3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm.nb(formula = AcaroBrachy ~ CuentaAgua + Topo + Sustrato, 
    data = ac, init.theta = 1.368777835, link = log)

Coefficients:
                    Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)        2.327e+00  5.328e-01   4.368 1.26e-05 ***
CuentaAgua        -1.622e-03  1.002e-03  -1.618   0.1056    
TopoHummock        6.832e-01  2.844e-01   2.402   0.0163 *  
SustratoSphagn2    4.935e-01  3.429e-01   1.439   0.1501    
SustratoSphagn3    1.474e+00  9.656e-01   1.527   0.1269    
SustratoSphagn4   -7.238e-01  7.070e-01  -1.024   0.3060    
SustratoLitter    -1.108e+00  7.713e-01  -1.436   0.1509    
SustratoBarepeat  -2.855e+01  3.628e+05   0.000   0.9999    
SustratoInterface  2.144e-01  2.792e-01   0.768   0.4426    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for Negative Binomial(1.3688) family taken to be 1)

    Null deviance: 106.812  on 69  degrees of freedom
Residual deviance:  75.357  on 61  degrees of freedom
AIC: 443.93

Number of Fisher Scoring iterations: 1

              Theta:  1.369 
          Std. Err.:  0.275 

 2 x log-likelihood:  -423.927 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pero se sale similar que el topo hummock es super significante y con el error más chico</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Siempre, siempre probar sus modelos después de elegirlas, porque sus resultados no son validos si no cumpla con los supuestos.</p>
</section>
<section id="regresión-backward" class="level3">
<h3 class="anchored" data-anchor-id="regresión-backward">3. regresión ‘backward’</h3>
<p>Regresión hacia atrás, o sea, backward, es lo mismo idea que ‘forward’ pero empezamos con un modelo lleno y eliminar variables en vez de añadir. La distinción entre eso y la versión ‘stepwise’ es que acá hice todo el mismo tiempo. Puede ser bueno, pero también hay más posibilidad de error porque no prueba los supuestos en cada etapa.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>ModVac <span class="ot">&lt;-</span> <span class="fu">glm.nb</span>(<span class="at">data=</span>ac, AcaroBrachy <span class="sc">~</span> <span class="dv">1</span>)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>ModTodo <span class="ot">&lt;-</span> <span class="fu">glm.nb</span>(<span class="at">data=</span>ac, AcaroBrachy <span class="sc">~</span> DensSustrato <span class="sc">+</span> CuentaAgua <span class="sc">+</span> Sustrato <span class="sc">+</span> Topo )</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="co"># acá empieza con el modelo lleno, porque va a eliminar no añadir</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>Mod_forward <span class="ot">&lt;-</span> <span class="fu">step</span>(ModTodo, <span class="at">scope=</span><span class="fu">list</span>(<span class="at">lower=</span>ModVac, <span class="at">upper=</span>ModTodo), <span class="at">direction=</span><span class="st">'backward'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=443.15
AcaroBrachy ~ DensSustrato + CuentaAgua + Sustrato + Topo

               Df Deviance    AIC
- DensSustrato  1   76.135 441.93
&lt;none&gt;              75.355 443.15
- CuentaAgua    1   78.456 444.25
- Sustrato      6   91.139 446.94
- Topo          1   81.171 446.97

Step:  AIC=441.93
AcaroBrachy ~ CuentaAgua + Sustrato + Topo

             Df Deviance    AIC
&lt;none&gt;            75.357 441.93
- CuentaAgua  1   77.882 442.45
- Sustrato    6   90.229 444.80
- Topo        1   80.967 445.54</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>RB3 <span class="ot">&lt;-</span> <span class="fu">glm.nb</span>(<span class="at">data=</span>ac, AcaroBrachy <span class="sc">~</span> CuentaAgua <span class="sc">+</span> Sustrato <span class="sc">+</span> Topo)</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>RB3 <span class="ot">&lt;-</span> <span class="fu">glm.nb</span>(<span class="at">data=</span>ac, AcaroBrachy <span class="sc">~</span> CuentaAgua <span class="sc">+</span> Topo <span class="sc">+</span> Sustrato)</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>simResRB3 <span class="ot">&lt;-</span><span class="fu">simulateResiduals</span>(RB3) </span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(simResRB3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="C9-modelosnormales2_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(RB3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               GVIF Df GVIF^(1/(2*Df))
CuentaAgua 1.420439  1        1.191822
Topo       1.524958  1        1.234892
Sustrato   1.425558  6        1.029988</code></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># podemos ver que no es exactamente bien</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(RB3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm.nb(formula = AcaroBrachy ~ CuentaAgua + Topo + Sustrato, 
    data = ac, init.theta = 1.368777835, link = log)

Coefficients:
                    Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)        2.327e+00  5.328e-01   4.368 1.26e-05 ***
CuentaAgua        -1.622e-03  1.002e-03  -1.618   0.1056    
TopoHummock        6.832e-01  2.844e-01   2.402   0.0163 *  
SustratoSphagn2    4.935e-01  3.429e-01   1.439   0.1501    
SustratoSphagn3    1.474e+00  9.656e-01   1.527   0.1269    
SustratoSphagn4   -7.238e-01  7.070e-01  -1.024   0.3060    
SustratoLitter    -1.108e+00  7.713e-01  -1.436   0.1509    
SustratoBarepeat  -2.855e+01  3.628e+05   0.000   0.9999    
SustratoInterface  2.144e-01  2.792e-01   0.768   0.4426    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for Negative Binomial(1.3688) family taken to be 1)

    Null deviance: 106.812  on 69  degrees of freedom
Residual deviance:  75.357  on 61  degrees of freedom
AIC: 443.93

Number of Fisher Scoring iterations: 1

              Theta:  1.369 
          Std. Err.:  0.275 

 2 x log-likelihood:  -423.927 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(RB3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: not plotting observations with leverage one:
  11</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="C9-modelosnormales2_files/figure-html/unnamed-chunk-25-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="C9-modelosnormales2_files/figure-html/unnamed-chunk-25-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="C9-modelosnormales2_files/figure-html/unnamed-chunk-25-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="C9-modelosnormales2_files/figure-html/unnamed-chunk-25-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Acá se sale lo mismo como regresión ‘forward’ pero distinto a ‘stepwise backward’. Depende en su cantidad de variables, puede salir de cualquier manera.</p>
</section>
</section>
<section id="recursos-adicionales" class="level1">
<h1>recursos adicionales</h1>
<p><a href="https://www.youtube.com/watch?v=boPyjojYHUY">Video de interpretar modelos- English</a></p>
<p><a href="https://www.youtube.com/watch?v=tCXc2zl3dew">Tipos de elección- Español</a></p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./C8-modelosnormales1.html" class="pagination-link" aria-label="Anova &amp; Kruskal-Wallis">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Anova &amp; Kruskal-Wallis</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./C10-modelosnonparametricos.html" class="pagination-link" aria-label="Variables con GLM/GAM">
        <span class="nav-page-text">Variables con GLM/GAM</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>